import { expect, test } from "bun:test";
import { floatToScaledBigIntLossy } from ".";
const cvt = floatToScaledBigIntLossy;
test("floatToScaledBigInt", () => {
    expect(() => cvt(0, -1)).toThrow();
    expect(() => cvt(NaN, 0)).toThrow();
    expect(() => cvt(Infinity, 0)).toThrow();
    expect(cvt(0, 0)).toBe(0n);
    expect(cvt(0, 1)).toBe(0n);
    expect(cvt(0, 100)).toBe(0n);
    for (let i = 1; i < 100; i++) {
        expect(cvt(123456, i)).toBe(123456n * 10n ** BigInt(i));
    }
    expect(cvt(0.12345, 2)).toBe(12n);
    expect(cvt(0.12345, 8)).toBe(12345000n);
    for (let i = 9; i < 100; i++) {
        expect(cvt(0.123456789, i)).toBe(123456789n * 10n ** BigInt(i - 9));
    }
    expect(cvt(0.00000021, 7)).toBe(2n);
    expect(cvt(0.00000021, 9)).toBe(210n);
    expect(cvt(0.0000000055, 7)).toBe(0n);
    expect(cvt(0.0000000055, 9)).toBe(5n);
    expect(cvt(0.0000000055, 10)).toBe(55n);
    expect(cvt(0.0000000055, 20)).toBe(55n * 10n ** BigInt(10));
});
